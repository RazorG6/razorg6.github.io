(function WP$Billing$Shared$PaymentAmountController$definition(){var n="#option_label_other",e="aria-hidden",m="required",d="false",i="data-amount",b="true",h="aria-disabled",a=true,g="disabled",l="[data-amount-type='",c=false,j=null,k="function",o=function WP$Billing$Shared$PaymentAmountController$(a,b){if(typeof a===k)this._afterAmountChangeCallback=a;this._invalidAmountString=b;this.WP$Controllers$Controller()},f={Default:0,AmountDue:1,Outstanding:2,Other:3},p={_afterAmountChangeCallback:j,_$radioButtons:j,_$otherAmountInput:j,_isOtherAmountDirty:c,_invalidAmountString:"",setupEventListeners:function WP$Billing$Shared$PaymentAmountController$setupEventListeners(){var a=this;a._$radioButtons=$afe.select(".payment_amount_selector input[type='radio'][name='payment_option']");a._$radioButtons.on("change",$.proxy(a.__onSelectionChange,a));a._$otherAmountInput=$afe.select(".payment_amount_selector .option_amount.other_option > input");a._$otherAmountInput.on("blur",$.proxy(a.__onOtherAmountBlur,a));a._$otherAmountInput.on("keydown",$.proxy(a.__onOtherAmountKeyDown,a));a._$otherAmountInput.on("input",$.proxy(a.__onOtherAmountInput,a))},setPaymentAmountSelection:function WP$Billing$Shared$PaymentAmountController$setPaymentAmountSelection(e){var c=this,i=+e.Type,d=c._$radioButtons.filter(l+i+"']");if(d.length===0){c._$otherAmountInput.prop(g,a).safeAttr(h,b);return}switch(i){case f.AmountDue:case f.Outstanding:if(!d.is(":disabled")){d.prop("checked",a);d.trigger("change")}c.__disableOtherAmountInput();break;case f.Other:c.__enableOtherAmountInput();c._$otherAmountInput.val(e.Amount);c._$otherAmountInput.trigger("input");c._$otherAmountInput.trigger("blur")}},__onOtherAmountBlur:function WP$Billing$Shared$PaymentAmountController$__onOtherAmountBlur(){var e="data-value",b=this;if(!b._isOtherAmountDirty)return;b._isOtherAmountDirty=c;var d=$$WP.Currency.Helpers.currencyToNumber(b._$otherAmountInput.val()),h=$$WP.Currency.Helpers.numberToCurrency(d,a,a),g=b._$radioButtons.filter(l+f.Other+"']");if(isNaN(d)||d<=0||d>parseFloat(b._$otherAmountInput.safeAttr("max"))){b._$otherAmountInput.safeAttr(e,"");g.safeAttr(i,"");b.__setOtherAmountErrorMessage(c);d=0}else{b.__setOtherAmountErrorMessage(a);b._$otherAmountInput.val(h);b._$otherAmountInput.safeAttr(e,d);g.safeAttr(i,d)}g.prop("checked",a);b.__onSelectionChange(j,f.Other,d)},__onOtherAmountKeyDown:function WP$Billing$Shared$PaymentAmountController$__onOtherAmountKeyDown(a){a.which===9&&this.__onOtherAmountBlur(a);if(a.which===13){this.__onOtherAmountBlur(a);a.stopPropagation();a.preventDefault()}},__onOtherAmountInput:function WP$Billing$Shared$PaymentAmountController$__onOtherAmountInput(){this._isOtherAmountDirty=a},__onSelectionChange:function WP$Billing$Shared$PaymentAmountController$__onSelectionChange(h,e,g){var c="selected",b=this;if(h){var d=$afe.jq(h.delegateTarget);$afe.select(".flatradio.container").removeClass(c);d.parent().addClass(c);e=+d.safeAttr("data-amount-type");g=+d.safeAttr(i)}if(e===f.Other)b.__enableOtherAmountInput();else{b.__disableOtherAmountInput();b.__setOtherAmountErrorMessage(a)}if(typeof b._afterAmountChangeCallback===k){var j={Type:e,Amount:g};b._afterAmountChangeCallback(j)}},__setOtherAmountErrorMessage:function WP$Billing$Shared$PaymentAmountController$__setOtherAmountErrorMessage(f){var c="#payment_amount_error",a="aria-invalid",e=this;if(f){e._$otherAmountInput.safeAttr(a,d);$afe.select("#payment_amount_error_message").empty();$afe.select(c).hide()}else{e._$otherAmountInput.safeAttr(a,b);$afe.select(c).empty().safeAppend($$WP.SimpleTemplates.ValidationMessage(e._invalidAmountString)).show();e._$otherAmountInput.focus()}},__enableOtherAmountInput:function WP$Billing$Shared$PaymentAmountController$__enableOtherAmountInput(){this._$otherAmountInput.prop(g,c).prop(m,a).safeAttr(h,d);this._$otherAmountInput.safeAttr(e,d);$afe.select(n).safeAttr(e,b)},__disableOtherAmountInput:function WP$Billing$Shared$PaymentAmountController$__disableOtherAmountInput(){this._$otherAmountInput.prop(g,a).prop(m,c).safeAttr(h,b);this._$otherAmountInput.safeAttr(e,b);$afe.select(n).safeAttr(e,d)}};o.prototype=p;$$WP=$$WP||{};$$WP.Billing=$$WP.Billing||{};$$WP.Billing.Shared=$$WP.Billing.Shared||{};$$WP.Billing.Shared.PaymentAmountController=o;$$WP.Billing.Shared.PaymentAmountType=f;o.extend($$WP.Controllers.Controller,"WP$Billing$Shared$PaymentAmountController")})()