(function WP$PI$AC$definition(){var e="_Country",b="#",c=null,a="",s_getValIfExists,d=[],f=function AddressController(i,h,b,c,f,e,g){var a=this;a._prefix=i;a._requiredFields=c||[];a._isPatientAddress=f===true;a.__disableRTL=e;a._vrkFields=g||[];if(b&&b.DefaultCountryCat!=="153"){a._defaultAddressConfiguration=b.DefaultCountryCat;if(b.DefaultCountryCat&&!d[b.DefaultCountryCat])d[b.DefaultCountryCat]=b}a.WP$Controllers$Controller();a.proxify("_onCountryChanged");a.setViewModel(h)},g={ViewModel:{},_isPatientAddress:false,_prefix:a,_requiredFields:[],_vrkFields:[],_defaultAddressConfiguration:"1",_lastFocusedElementId:a,__disableRTL:false,_onCountryChanged:function _onCountryChanged(){this.updateViewModel();this.render()},_onAddressConfigurationLoadSuccess:function _onAddressConfigurationLoadSuccess(a){a.DefaultCountryCat=String(a.DefaultCountryCat);d[a.DefaultCountryCat]=a;this._trueRender();this.onDataLoadEnd()},onDataLoadStart:function onDataLoadStart(){},onDataLoadEnd:function onDataLoadEnd(){},setViewModel:function setViewModel(d){var b=this,f,e;if(d)b.ViewModel={HouseNumber:d.HouseNumber,Street:d.Street,City:d.City,County:{Number:d.County.Number},State:{Number:d.State.Number},Zip:d.Zip,Country:{Number:d.Country.Number||b._defaultAddressConfiguration},District:{Number:d.District.Number},Building:b._isPatientAddress?d.Building:a,Floor:b._isPatientAddress?d.Floor:a,Unit:b._isPatientAddress?d.Unit:a};else b.ViewModel={HouseNumber:a,Street:a,City:a,County:{Number:c},State:{Number:c},Zip:a,Country:{Number:b._defaultAddressConfiguration},District:{Number:c},Building:a,Floor:a,Unit:a};b.ViewModel.Prefix=b._prefix;f={};for(e=0;e<b._requiredFields.length;e++)if(!b._vrkFields[b._requiredFields[e]])f[b._requiredFields[e]]=true;b.ViewModel.RequiredFieldNames=f;b.ViewModel.VRKFieldNames=b._vrkFields;b.ViewModel.Validation={Required:$$WP.FormValidation.ValidationSettings.Required};b.ViewModel.Validation.StreetAddress=new $$WP.FormValidation.ValidationSettings({required:b.ViewModel.RequiredFieldNames.Street,maxLength:254});b.ViewModel.Validation.City=new $$WP.FormValidation.ValidationSettings({required:b.ViewModel.RequiredFieldNames.City,maxLength:50});b.ViewModel.Validation.HouseNumber=new $$WP.FormValidation.ValidationSettings({required:b.ViewModel.RequiredFieldNames.HouseNumber,maxLength:254});b.ViewModel.Validation.Building=new $$WP.FormValidation.ValidationSettings({required:b.ViewModel.RequiredFieldNames.Building,maxLength:254});b.ViewModel.Validation.Floor=new $$WP.FormValidation.ValidationSettings({required:b.ViewModel.RequiredFieldNames.Floor,maxLength:254});b.ViewModel.Validation.Unit=new $$WP.FormValidation.ValidationSettings({required:b.ViewModel.RequiredFieldNames.Unit,maxLength:18})},updateViewModel:function updateViewModel(){var d=this,i,m,o,l,n,p,k,j,f,g,h;if(d.$root===c)return;i=$afe.select(b+d._prefix+"_HouseNumber",d.$root);m=$afe.select(b+d._prefix+"_Street",d.$root);o=$afe.select(b+d._prefix+"_City",d.$root);l=$afe.select(b+d._prefix+"_County",d.$root);n=$afe.select(b+d._prefix+"_State",d.$root);p=$afe.select(b+d._prefix+"_Zip",d.$root);k=$afe.select(b+d._prefix+e,d.$root);j=$afe.select(b+d._prefix+"_District",d.$root);if(d._isPatientAddress){f=$afe.select(b+d._prefix+"_Building",d.$root);g=$afe.select(b+d._prefix+"_Floor",d.$root);h=$afe.select(b+d._prefix+"_Unit",d.$root)}else{f=a;g=a;h=a}d.ViewModel=d.ViewModel||{};d.ViewModel.HouseNumber=s_getValIfExists(i);d.ViewModel.Street=s_getValIfExists(m);d.ViewModel.City=s_getValIfExists(o);d.ViewModel.County.Number=s_getValIfExists(l);d.ViewModel.State.Number=s_getValIfExists(n);d.ViewModel.Zip=s_getValIfExists(p);d.ViewModel.Country.Number=s_getValIfExists(k);d.ViewModel.District.Number=s_getValIfExists(j);d.ViewModel.Building=s_getValIfExists(f);d.ViewModel.Floor=s_getValIfExists(g);d.ViewModel.Unit=s_getValIfExists(h)},getViewModel:function getViewModel(){var a=this;a.updateViewModel();return{HouseNumber:a.ViewModel.HouseNumber,Street:a.ViewModel.Street,City:a.ViewModel.City,County:{Number:a.ViewModel.County.Number},State:{Number:a.ViewModel.State.Number},Zip:a.ViewModel.Zip,Country:{Number:a.ViewModel.Country.Number},District:{Number:a.ViewModel.District.Number},Building:a.ViewModel.Building,Floor:a.ViewModel.Floor,Unit:a.ViewModel.Unit}},_trueRender:function _trueRender(){var e=this,f;e.$root.empty();e.ViewModel.AddressConfiguration=e.ViewModel.Country!==c?d[String(e.ViewModel.Country.Number)]:d[e._defaultAddressConfiguration];e.$root.safeAppend($afe.renderTemplate($$WP.Templates.PersonalInformation.BaseAddress,e.ViewModel)).removeClass("loading");f=$afe.select(b+e._lastFocusedElementId);f.length!==0&&f.focus();e._lastFocusedElementId=a;e.afterRender()},render:function render(){var f="change.addressCountryChange",a=this;if(a.$root.length===0)return;if(document.activeElement!==c&&document.activeElement.id)a._lastFocusedElementId=document.activeElement.id;a.$root.off(f).on(f,b+a._prefix+e,a._onCountryChanged);if(d[a.ViewModel.Country.Number]){a._trueRender();return}a.onDataLoadStart();a.$root.find("textarea,input,select").prop("disabled",true);a.$root.addClass("loading").safePrepend($$WP.SimpleTemplates.Div({"class":"loadingIndicator"}).safeAppend($$WP.SimpleTemplates.Div({"class":"indicator"})));$.ajax({type:"POST",url:makeLink("PersonalInformation/GetAddressConfiguration"),data:{countryId:a.ViewModel.Country.Number,isPatientAddress:a._isPatientAddress,disableRTL:a.__disableRTL},dataType:"json",success:$.proxy(a._onAddressConfigurationLoadSuccess,a)})},renderTo:function renderTo(a){this.$root=a;this.render()},afterRender:function afterRender(){}};s_getValIfExists=function s_getValIfExists(a){return a.length===1?a.val():c};f.prototype=g;$$WP.PersonalInformation=$$WP.PersonalInformation||{};$$WP.PersonalInformation.AddressController=f;f.extend($$WP.Controllers.Controller,"WP$PersonalInformation$Controllers$AddressController")})()